{"version":3,"file":"listing-info/index.js","mappings":";;;;;;;;;;;;;;;;;;;;AAAA;;;;;;;;;;ACAA;;;;;;;;;;ACAA;;;;;;;;;;ACAA;;;;;;;;;;ACAA;;;;;;;;;;ACAA;;;;;;UCAA;UACA;;UAEA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;;UAEA;UACA;;UAEA;UACA;UACA;;;;;WCtBA;WACA;WACA;WACA;WACA;WACA,iCAAiC,WAAW;WAC5C;WACA;;;;;WCPA;WACA;WACA;WACA;WACA,yCAAyC,wCAAwC;WACjF;WACA;WACA;;;;;WCPA;;;;;WCAA;WACA;WACA;WACA,uDAAuD,iBAAiB;WACxE;WACA,gDAAgD,aAAa;WAC7D;;;;;;;;;;;;;;;;;;;;;;;;;ACNsD;AACV;AAC+B;AACtC;AACoD;AACrD;AAEpCA,oEAAiB,CAACS,6CAAa,EAAE;EAC7BE,IAAI,EAAE,SAASC,IAAIA,CAAC;IAAEC,UAAU;IAAEC;EAAc,CAAC,EAAE;IAC/C,MAAMC,UAAU,GAAGb,sEAAa,CAAC,CAAC;IAClC,MAAM;MAAEc,SAAS;MAAEC,SAAS;MAAEC,SAAS;MAAEC,SAAS;MAAEC,WAAW;MAAEC,SAAS;MAAEC;IAAS,CAAC,GAAGT,UAAU;;IAEnG;IACA,MAAMU,QAAQ,GAAGtB,0DAAS,CAAEuB,MAAM,IAAK;MACnC,OAAOA,MAAM,CAAC,MAAM,CAAC,CAACC,gBAAgB,CAAC,UAAU,EAAE,SAAS,EAAE;QAC1DC,QAAQ,EAAE,CAAC,CAAC;QACZC,MAAM,EAAE;MACZ,CAAC,CAAC;IACN,CAAC,EAAE,EAAE,CAAC;;IAEN;IACA,MAAMC,OAAO,GAAG3B,0DAAS,CAAEuB,MAAM,IAAK;MAClC,IAAI,CAACR,SAAS,EAAE,OAAO,IAAI;MAC3B,OAAOQ,MAAM,CAAC,MAAM,CAAC,CAACK,eAAe,CAAC,UAAU,EAAE,SAAS,EAAEb,SAAS,EAAE;QACpEW,MAAM,EAAE,IAAI;QACZG,OAAO,EAAE,CACL,IAAI,EACJ,OAAO,EACP,SAAS,EACT,MAAM,EACN,WAAW;MAEnB,CAAC,CAAC;IACN,CAAC,EAAE,CAACd,SAAS,CAAC,CAAC;IAEf,IAAI,CAACA,SAAS,EAAE;MACZ,OACIe,oDAAA;QAAA,GAAShB;MAAU,GACfgB,oDAAA;QAAKC,SAAS,EAAC;MAAwB,GACnCD,oDAAA;QAAKC,SAAS,EAAC;MAA+B,GACzC5B,mDAAE,CAAC,cAAc,EAAE,UAAU,CAC7B,CAAC,EACN2B,oDAAA;QAAKC,SAAS,EAAC;MAAsC,GAChD5B,mDAAE,CAAC,qDAAqD,EAAE,UAAU,CACpE,CAAC,EACN2B,oDAAA,CAACxB,gEAAa;QACV0B,KAAK,EAAE7B,mDAAE,CAAC,kBAAkB,EAAE,UAAU,CAAE;QAC1C8B,KAAK,EAAElB,SAAU;QACjBmB,OAAO,EAAE,CACL;UAAEF,KAAK,EAAE7B,mDAAE,CAAC,kBAAkB,EAAE,UAAU,CAAC;UAAE8B,KAAK,EAAE;QAAE,CAAC,EACvD,GAAG,CAACX,QAAQ,IAAI,EAAE,EAAEa,GAAG,CAACR,OAAO,KAAK;UAChCK,KAAK,EAAEL,OAAO,CAACS,KAAK,CAACC,QAAQ;UAC7BJ,KAAK,EAAEN,OAAO,CAACW;QACnB,CAAC,CAAC,CAAC,CACL;QACFC,QAAQ,EAAGN,KAAK,IAAKpB,aAAa,CAAC;UAAEE,SAAS,EAAEyB,QAAQ,CAACP,KAAK;QAAE,CAAC;MAAE,CACtE,CACA,CACJ,CAAC;IAEd;IAEA,IAAI,CAACN,OAAO,EAAE;MACV,OACIG,oDAAA;QAAA,GAAShB;MAAU,GACfgB,oDAAA,CAAC1B,0DAAO,MAAE,CACT,CAAC;IAEd;;IAEA;IACAqC,OAAO,CAACC,GAAG,CAACf,OAAO,CAAC;IACpB,MAAMgB,IAAI,GAAGhB,OAAO,CAACgB,IAAI,IAAI,CAAC,CAAC;IAC/B,MAAM;MACFC,cAAc,GAAG,EAAE;MACnBC,mBAAmB,GAAG,EAAE;MACxBC,cAAc,GAAG,EAAE;MACnBC,aAAa,GAAG;IACpB,CAAC,GAAGJ,IAAI;IAER,OACIb,oDAAA,CAAAkB,2CAAA,QACIlB,oDAAA,CAAC5B,sEAAiB,QACd4B,oDAAA,CAACzB,4DAAS;MAAC+B,KAAK,EAAEjC,mDAAE,CAAC,kBAAkB,EAAE,UAAU;IAAE,GACjD2B,oDAAA,CAACxB,gEAAa;MACV0B,KAAK,EAAE7B,mDAAE,CAAC,kBAAkB,EAAE,UAAU,CAAE;MAC1C8B,KAAK,EAAElB,SAAU;MACjBmB,OAAO,EAAE,CACL;QAAEF,KAAK,EAAE7B,mDAAE,CAAC,kBAAkB,EAAE,UAAU,CAAC;QAAE8B,KAAK,EAAE;MAAE,CAAC,EACvD,GAAG,CAACX,QAAQ,IAAI,EAAE,EAAEa,GAAG,CAACR,OAAO,KAAK;QAChCK,KAAK,EAAEL,OAAO,CAACS,KAAK,CAACC,QAAQ;QAC7BJ,KAAK,EAAEN,OAAO,CAACW;MACnB,CAAC,CAAC,CAAC,CACL;MACFC,QAAQ,EAAGN,KAAK,IAAKpB,aAAa,CAAC;QAAEE,SAAS,EAAEyB,QAAQ,CAACP,KAAK;MAAE,CAAC;IAAE,CACtE,CAAC,EACFH,oDAAA,CAACvB,gEAAa;MACVyB,KAAK,EAAE7B,mDAAE,CAAC,YAAY,EAAE,UAAU,CAAE;MACpC8C,OAAO,EAAEjC,SAAU;MACnBuB,QAAQ,EAAEA,CAAA,KAAM1B,aAAa,CAAC;QAAEG,SAAS,EAAE,CAACA;MAAU,CAAC;IAAE,CAC5D,CAAC,EACFc,oDAAA,CAACvB,gEAAa;MACVyB,KAAK,EAAE7B,mDAAE,CAAC,YAAY,EAAE,UAAU,CAAE;MACpC8C,OAAO,EAAEhC,SAAU;MACnBsB,QAAQ,EAAEA,CAAA,KAAM1B,aAAa,CAAC;QAAEI,SAAS,EAAE,CAACA;MAAU,CAAC;IAAE,CAC5D,CAAC,EACFa,oDAAA,CAACvB,gEAAa;MACVyB,KAAK,EAAE7B,mDAAE,CAAC,YAAY,EAAE,UAAU,CAAE;MACpC8C,OAAO,EAAE/B,SAAU;MACnBqB,QAAQ,EAAEA,CAAA,KAAM1B,aAAa,CAAC;QAAEK,SAAS,EAAE,CAACA;MAAU,CAAC;IAAE,CAC5D,CAAC,EACFY,oDAAA,CAACvB,gEAAa;MACVyB,KAAK,EAAE7B,mDAAE,CAAC,cAAc,EAAE,UAAU,CAAE;MACtC8C,OAAO,EAAE9B,WAAY;MACrBoB,QAAQ,EAAEA,CAAA,KAAM1B,aAAa,CAAC;QAAEM,WAAW,EAAE,CAACA;MAAY,CAAC;IAAE,CAChE,CAAC,EACFW,oDAAA,CAACvB,gEAAa;MACVyB,KAAK,EAAE7B,mDAAE,CAAC,YAAY,EAAE,UAAU,CAAE;MACpC8C,OAAO,EAAE7B,SAAU;MACnBmB,QAAQ,EAAEA,CAAA,KAAM1B,aAAa,CAAC;QAAEO,SAAS,EAAE,CAACA;MAAU,CAAC;IAAE,CAC5D,CAAC,EACFU,oDAAA,CAACvB,gEAAa;MACVyB,KAAK,EAAE7B,mDAAE,CAAC,WAAW,EAAE,UAAU,CAAE;MACnC8C,OAAO,EAAE5B,QAAS;MAClBkB,QAAQ,EAAEA,CAAA,KAAM1B,aAAa,CAAC;QAAEQ,QAAQ,EAAE,CAACA;MAAS,CAAC;IAAE,CAC1D,CACM,CACI,CAAC,EAEpBS,oDAAA;MAAA,GAAShB;IAAU,GACfgB,oDAAA;MAAKC,SAAS,EAAC;IAAoB,GAC9Bb,SAAS,IAAIS,OAAO,CAACuB,SAAS,GAAG,kBAAkB,CAAC,GAAG,CAAC,CAAC,IACtDpB,oDAAA;MAAKC,SAAS,EAAC;IAAe,GAC1BD,oDAAA;MACIqB,GAAG,EAAExB,OAAO,CAACuB,SAAS,CAAC,kBAAkB,CAAC,CAAC,CAAC,CAAC,CAACE,UAAW;MACzDC,GAAG,EAAE1B,OAAO,CAACS,KAAK,CAACC;IAAS,CAC/B,CACA,CACR,EAEArB,SAAS,IACNc,oDAAA;MAAIC,SAAS,EAAC;IAAe,GAAEJ,OAAO,CAACS,KAAK,CAACC,QAAa,CAC7D,EAEApB,SAAS,IACNa,oDAAA;MAAKC,SAAS,EAAC;IAAe,GACzBc,mBAAmB,GAChBf,oDAAA,CAAAkB,2CAAA,QACIlB,oDAAA;MAAMC,SAAS,EAAC;IAAY,GACvB5B,mDAAE,CAAC,aAAa,EAAE,UAAU,CAAC,EAAC,IAAE,EAAC0C,mBAChC,CAAC,EACPf,oDAAA;MAAMC,SAAS,EAAC;IAAgB,GAC3B5B,mDAAE,CAAC,iBAAiB,EAAE,UAAU,CAAC,EAAC,IAAE,EAACyC,cACpC,CACR,CAAC,GAEHd,oDAAA;MAAMC,SAAS,EAAC;IAAe,GAC1B5B,mDAAE,CAAC,QAAQ,EAAE,UAAU,CAAC,EAAC,IAAE,EAACyC,cAC3B,CAET,CACR,EAEAzB,WAAW,IACRW,oDAAA;MAAKC,SAAS,EAAC;IAAiB,GAC3BJ,OAAO,CAAC2B,OAAO,CAACjB,QAChB,CACR,EAEDP,oDAAA;MAAKC,SAAS,EAAC;IAAiB,GAC3BX,SAAS,IAAI0B,cAAc,IACxBhB,oDAAA;MAAKC,SAAS,EAAC;IAAe,GAC1BD,oDAAA,iBAAS3B,mDAAE,CAAC,QAAQ,EAAE,UAAU,CAAU,CAAC,EAC1C2C,cACA,CACR,EACAzB,QAAQ,IAAI0B,aAAa,IACtBjB,oDAAA;MAAKC,SAAS,EAAC;IAAc,GACzBD,oDAAA,iBAAS3B,mDAAE,CAAC,OAAO,EAAE,UAAU,CAAU,CAAC,EACzC4C,aAAa,EAAC,QACd,CAER,CACJ,CACJ,CACP,CAAC;EAEX,CAAC;EAEDQ,IAAI,EAAE,SAASC,IAAIA,CAAA,EAAG;IAClB,OAAO,IAAI,CAAC,CAAC;EACjB;AACJ,CAAC,CAAC,C","sources":["webpack://listings/external window [\"wp\",\"blockEditor\"]","webpack://listings/external window [\"wp\",\"blocks\"]","webpack://listings/external window [\"wp\",\"components\"]","webpack://listings/external window [\"wp\",\"data\"]","webpack://listings/external window [\"wp\",\"i18n\"]","webpack://listings/external window \"React\"","webpack://listings/webpack/bootstrap","webpack://listings/webpack/runtime/compat get default export","webpack://listings/webpack/runtime/define property getters","webpack://listings/webpack/runtime/hasOwnProperty shorthand","webpack://listings/webpack/runtime/make namespace object","webpack://listings/./blocks/listing-info/index.js"],"sourcesContent":["module.exports = window[\"wp\"][\"blockEditor\"];","module.exports = window[\"wp\"][\"blocks\"];","module.exports = window[\"wp\"][\"components\"];","module.exports = window[\"wp\"][\"data\"];","module.exports = window[\"wp\"][\"i18n\"];","module.exports = window[\"React\"];","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","import { registerBlockType } from '@wordpress/blocks';\nimport { useSelect } from '@wordpress/data';\nimport { useBlockProps, InspectorControls } from '@wordpress/block-editor';\nimport { __ } from '@wordpress/i18n';\nimport { Spinner, PanelBody, SelectControl, ToggleControl } from '@wordpress/components';\nimport metadata from './block.json';\n\nregisterBlockType(metadata.name, {\n    edit: function Edit({ attributes, setAttributes }) {\n        const blockProps = useBlockProps();\n        const { listingId, showTitle, showPrice, showImage, showExcerpt, showRooms, showArea } = attributes;\n\n        // Fetch all listings for the dropdown\n        const listings = useSelect((select) => {\n            return select('core').getEntityRecords('postType', 'listing', {\n                per_page: -1,\n                _embed: true\n            });\n        }, []);\n\n        // Fetch selected listing with meta fields\n        const listing = useSelect((select) => {\n            if (!listingId) return null;\n            return select('core').getEntityRecord('postType', 'listing', listingId, {\n                _embed: true,\n                _fields: [\n                    'id',\n                    'title',\n                    'excerpt',\n                    'meta',\n                    '_embedded'\n                ]\n            });\n        }, [listingId]);\n\n        if (!listingId) {\n            return (\n                <div {...blockProps}>\n                    <div className=\"components-placeholder\">\n                        <div className=\"components-placeholder__label\">\n                            {__('Listing Info', 'listings')}\n                        </div>\n                        <div className=\"components-placeholder__instructions\">\n                            {__('Please select a listing to display its information.', 'listings')}\n                        </div>\n                        <SelectControl\n                            label={__('Select a listing', 'listings')}\n                            value={listingId}\n                            options={[\n                                { label: __('Select a listing', 'listings'), value: 0 },\n                                ...(listings || []).map(listing => ({\n                                    label: listing.title.rendered,\n                                    value: listing.id\n                                }))\n                            ]}\n                            onChange={(value) => setAttributes({ listingId: parseInt(value) })}\n                        />\n                    </div>\n                </div>\n            );\n        }\n\n        if (!listing) {\n            return (\n                <div {...blockProps}>\n                    <Spinner />\n                </div>\n            );\n        }\n\n        // Safely access meta fields with fallbacks\n        console.log(listing);\n        const meta = listing.meta || {};\n        const {\n            _listing_price = '',\n            _listing_sale_price = '',\n            _listing_rooms = '',\n            _listing_area = ''\n        } = meta;\n\n        return (\n            <>\n                <InspectorControls>\n                    <PanelBody title={__('Listing Settings', 'listings')}>\n                        <SelectControl\n                            label={__('Select a listing', 'listings')}\n                            value={listingId}\n                            options={[\n                                { label: __('Select a listing', 'listings'), value: 0 },\n                                ...(listings || []).map(listing => ({\n                                    label: listing.title.rendered,\n                                    value: listing.id\n                                }))\n                            ]}\n                            onChange={(value) => setAttributes({ listingId: parseInt(value) })}\n                        />\n                        <ToggleControl\n                            label={__('Show Title', 'listings')}\n                            checked={showTitle}\n                            onChange={() => setAttributes({ showTitle: !showTitle })}\n                        />\n                        <ToggleControl\n                            label={__('Show Price', 'listings')}\n                            checked={showPrice}\n                            onChange={() => setAttributes({ showPrice: !showPrice })}\n                        />\n                        <ToggleControl\n                            label={__('Show Image', 'listings')}\n                            checked={showImage}\n                            onChange={() => setAttributes({ showImage: !showImage })}\n                        />\n                        <ToggleControl\n                            label={__('Show Excerpt', 'listings')}\n                            checked={showExcerpt}\n                            onChange={() => setAttributes({ showExcerpt: !showExcerpt })}\n                        />\n                        <ToggleControl\n                            label={__('Show Rooms', 'listings')}\n                            checked={showRooms}\n                            onChange={() => setAttributes({ showRooms: !showRooms })}\n                        />\n                        <ToggleControl\n                            label={__('Show Area', 'listings')}\n                            checked={showArea}\n                            onChange={() => setAttributes({ showArea: !showArea })}\n                        />\n                    </PanelBody>\n                </InspectorControls>\n\n                <div {...blockProps}>\n                    <div className=\"listing-info-block\">\n                        {showImage && listing._embedded?.['wp:featuredmedia']?.[0] && (\n                            <div className=\"listing-image\">\n                                <img\n                                    src={listing._embedded['wp:featuredmedia'][0].source_url}\n                                    alt={listing.title.rendered}\n                                />\n                            </div>\n                        )}\n\n                        {showTitle && (\n                            <h2 className=\"listing-title\">{listing.title.rendered}</h2>\n                        )}\n\n                        {showPrice && (\n                            <div className=\"listing-price\">\n                                {_listing_sale_price ? (\n                                    <>\n                                        <span className=\"sale-price\">\n                                            {__('Sale Price:', 'listings')} ${_listing_sale_price}\n                                        </span>\n                                        <span className=\"original-price\">\n                                            {__('Original Price:', 'listings')} ${_listing_price}\n                                        </span>\n                                    </>\n                                ) : (\n                                    <span className=\"regular-price\">\n                                        {__('Price:', 'listings')} ${_listing_price}\n                                    </span>\n                                )}\n                            </div>\n                        )}\n\n                        {showExcerpt && (\n                            <div className=\"listing-excerpt\">\n                                {listing.excerpt.rendered}\n                            </div>\n                        )}\n\n                        <div className=\"listing-details\">\n                            {showRooms && _listing_rooms && (\n                                <div className=\"listing-rooms\">\n                                    <strong>{__('Rooms:', 'listings')}</strong>\n                                    {_listing_rooms}\n                                </div>\n                            )}\n                            {showArea && _listing_area && (\n                                <div className=\"listing-area\">\n                                    <strong>{__('Area:', 'listings')}</strong>\n                                    {_listing_area} m²\n                                </div>\n                            )}\n                        </div>\n                    </div>\n                </div>\n            </>\n        );\n    },\n\n    save: function Save() {\n        return null; // Dynamic block, render handled by PHP\n    }\n}); "],"names":["registerBlockType","useSelect","useBlockProps","InspectorControls","__","Spinner","PanelBody","SelectControl","ToggleControl","metadata","name","edit","Edit","attributes","setAttributes","blockProps","listingId","showTitle","showPrice","showImage","showExcerpt","showRooms","showArea","listings","select","getEntityRecords","per_page","_embed","listing","getEntityRecord","_fields","createElement","className","label","value","options","map","title","rendered","id","onChange","parseInt","console","log","meta","_listing_price","_listing_sale_price","_listing_rooms","_listing_area","Fragment","checked","_embedded","src","source_url","alt","excerpt","save","Save"],"sourceRoot":""}